[{"title":"macOS 安装 MySQL","date":"2017-01-15T02:04:00.000Z","path":"2017/01/15/mac/install-mysql/","text":"正文 首次在 macOS 上安装MySQL时会遇到很多问题，以下是我遇到的问题和解决方案 使用brew安装MySQL在命令行中输入 brew install mysql 安装MySQL。 下载dmg安装MySQL访问MySQL官网http://www.mysql.com/downloads/，点击下载MySQL Community Server，注意平台。 卸载MySQL使用brew安装MySQL的，可以执行 brew uninstall mysql 或者 brew remove mysql然后再执行以下命令：sudo rm /usr/local/mysqlsudo rm -rf /usr/local/mysql*sudo rm -rf /Library/StartupItems/MySQLCOMsudo rm -rf /Library/PreferencePanes/My*rm -rf ~/Library/PreferencePanes/My*sudo rm -rf /Library/Receipts/mysql*sudo rm -rf /Library/Receipts/MySQL* 再检查以下存储位置，如有文件，直接删除/usr/local/Cellar 里的mysql文件/usr/local/var 里的mysql文件/tmp 里的mysql.sock, mysql.sock.lock, my.cnf文件brew安装的安装包存储在/usr/local/Library/Cache/Homebrew也可以一并删除 最后执行 brew cleanup MySQL Workbench（GUI）MySQL官网上有 MySQL Workbench 的下载链接，访问https://downloads.mysql.com/archives/workbench/，点击下载MySQL Workbench(GUI Tool)，如果发现安装之后，进入Workbench后，执行SQL后，一直卡死，请下载6.1.7版本。 MySQL问题下面是我在使用MySQL时出现的问题： Access denied for user ‘’@’localhost’ to database’执行 mysql -u root -p 之后输入之前MySQL随机生成出来的密码，一直提示不正确的时候，我们就执行以下命令：mysqld stopmysqld_safe --skip-grant-tables &amp;mysql -u rootuse mysql;update user set authentication_string=password(&apos;123456&apos;) where user=&apos;root&apos;;flush privileges;quitmysqld restart You must reset your password using ALTER USER statement before executing this statement.当我们成功登录MySQL后，执行任何的命令，都提示上面的错误，我们需要执行以下命令：SET PASSWORD = PASSWORD(&apos;123456&apos;);ALTER USER &apos;root&apos;@&apos;localhost&apos; PASSWORD EXPIRE NEVER;flush privileges; 参考文献MAC下安装与配置MySQL在 Mac 下用 Homebrew 安装 MySQLworkbench 无法执行命令？Mac Pro下卸载安装Mysqlmysql-community-server 5.7.16 设置密码mac mysql error You must reset your password using ALTER USER statement before executing this statement.","tags":[{"name":"Mac","slug":"Mac","permalink":"http://zhensherlock.github.io/tags/Mac/"},{"name":"MySQL","slug":"MySQL","permalink":"http://zhensherlock.github.io/tags/MySQL/"}]},{"title":"Sierra 10.12 brew update 报错","date":"2017-01-12T08:04:00.000Z","path":"2017/01/12/mac/brew-update/","text":"正文 当 macOS 升级到Sierra 10.12后，执行brew update，出现以下错误： Error: /usr/local must be writable! 解决方案上面提示说没有权限，那我们就给当前用户在 /usr/local 路径的权限。 在命令行中执行： sudo chown -R whoami /usr/local 请将whoami替换成当前用户名 参考文献In macOS 10.12 Sierra, /usr/local is readonly“Error: /usr/local must be writable!” (Sierra 10.12 Beta (16A239j) )","tags":[{"name":"brew","slug":"brew","permalink":"http://zhensherlock.github.io/tags/brew/"},{"name":"Mac","slug":"Mac","permalink":"http://zhensherlock.github.io/tags/Mac/"}]},{"title":"国内NPM使用","date":"2017-01-12T08:04:00.000Z","path":"2017/01/12/npm-china/","text":"导语 NPM在国内使用时，下载速度有时会很慢，甚至有下载不了的情况，为了不影响项目开发进度，我们有以下几种方案（我们以安装underscore为例）。 临时修改在命令行中输入：npm install underscore -g --registry=https://registry.npm.taobao.org 全局修改在命令行中输入：npm config set registry https://registry.npm.taobao.org 编辑 ~/.npmrc 或者 C:\\Users\\Administrator\\.npmrc 加入下面内容registry = https://registry.npm.taobao.org 使用CNPM我们可以使用CNPM来代替NPM，CNPM的源和包都在国内，所以速度比NPM快的多，并且CNPM还支持gzip压缩。下面是macOS和Linux的安装方法。 macOS安装CNPM首先安装CNPMnpm install -g cnpm --registry=https://registry.npm.taobao.org 接一下在~/.bashrc或者~/.zshrc定义别名alias cnpm=&quot;npm --registry=https://registry.npm.taobao.org \\--cache=$HOME/.npm/.cache/cnpm \\--disturl=https://npm.taobao.org/mirrors/node \\--userconfig=$HOME/.cnpmrc&quot; Linux安装CNPM首先安装CNPMnpm install -g cnpm --registry=https://registry.npm.taobao.org 接一下在~/.bashrc或者~/.zshrc定义别名 echo &apos;\\n#alias for cnpm\\nalias cnpm=&quot;npm --registry=https://registry.npm.taobao.org \\--cache=$HOME/.npm/.cache/cnpm \\--disturl=https://npm.taobao.org/dist \\--userconfig=$HOME/.cnpmrc&quot;&apos; &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc 如何使用安装完成之后，我们就可以使用cnpm install [packagename]来安装模块了。 参考文献使用npm安装一些包失败了的看过来（npm国内镜像介绍）淘宝 NPM 镜像npm install 无响应解决方案","tags":[{"name":"NPM","slug":"NPM","permalink":"http://zhensherlock.github.io/tags/NPM/"}]},{"title":"Microsoft Office MIME Types","date":"2017-01-10T09:52:02.000Z","path":"2017/01/10/microsoft-office-mime-types/","text":"文正我们前端在做上传文件时，会遇到上传时要限制文件类型的需求，代码如下：&lt;input type=\"file\" accept=\"image/*\"&gt; 但是在最近高版本的标准浏览器会出现点击响应过慢的情况，后来改成下面的代码后，就没有问题了，代码如下：&lt;input type=\"file\" accept=\"image/gif,image/jpeg,image/jpg,image/png,image/svg\"&gt; 因为在使用image/*时，系统会为每个文件都遍历一下image下的所有类型，所以当文件较多的时候，会出现上传弹出框出现滞慢的情况。audio/* video/* 都会出现上述情况，建议将*通配符改成指定的MIME类型来实现。 微软办公软件MIME Type某些软件的文件按类型比较多，特别是微软办公软件的文件类型，下面是微软办公软件的MIME Type列表。 后缀名 MIME Type .doc application/msword .dot application/msword .docx application/vnd.openxmlformats-officedocument.wordprocessingml.document .dotx application/vnd.openxmlformats-officedocument.wordprocessingml.template .docm application/vnd.ms-word.document.macroEnabled.12 .dotm application/vnd.ms-word.template.macroEnabled.12 .xls application/vnd.ms-excel .xlt application/vnd.ms-excel .xla application/vnd.ms-excel .xlsx application/vnd.openxmlformats-officedocument.spreadsheetml.sheet .xltx application/vnd.openxmlformats-officedocument.spreadsheetml.template .xlsm application/vnd.ms-excel.sheet.macroEnabled.12 .xltm application/vnd.ms-excel.template.macroEnabled.12 .xlam application/vnd.ms-excel.addin.macroEnabled.12 .xlsb application/vnd.ms-excel.sheet.binary.macroEnabled.12 .ppt application/vnd.ms-powerpoint .pot application/vnd.ms-powerpoint .pps application/vnd.ms-powerpoint .ppa application/vnd.ms-powerpoint .pptx application/vnd.openxmlformats-officedocument.presentationml.presentation .potx application/vnd.openxmlformats-officedocument.presentationml.template .ppsx application/vnd.openxmlformats-officedocument.presentationml.slideshow .ppam application/vnd.ms-powerpoint.addin.macroEnabled.12 .pptm application/vnd.ms-powerpoint.presentation.macroEnabled.12 .potm application/vnd.ms-powerpoint.template.macroEnabled.12 .ppsm application/vnd.ms-powerpoint.slideshow.macroEnabled.12 Applications MIME Type Application MIME Type File Extension Corel Envoy application/envoy evy fractal image file application/fractals fif Windows print spool file application/futuresplash spl HTML application application/hta hta Atari ST Program application/internet-property-stream acx BinHex encoded file application/mac-binhex40 hqx Word document application/msword doc Word document template application/msword dot application/octet-stream * binary disk image application/octet-stream bin Java class file application/octet-stream class Disk Masher image application/octet-stream dms executable file application/octet-stream exe LHARC compressed archive application/octet-stream lha LZH compressed file application/octet-stream lzh CALS raster image application/oda oda ActiveX script application/olescript axs Acrobat file application/pdf pdf Outlook profile file application/pics-rules prf certificate request file application/pkcs10 p10 certificate revocation list file application/pkix-crl crl Adobe Illustrator file application/postscript ai postscript file application/postscript eps postscript file application/postscript ps rich text format file application/rtf rtf set payment initiation application/set-payment-initiation setpay set registration initiation application/set-registration-initiation setreg Excel Add-in file application/vnd.ms-excel xla Excel chart application/vnd.ms-excel xlc Excel macro application/vnd.ms-excel xlm Excel spreadsheet application/vnd.ms-excel xls Excel template application/vnd.ms-excel xlt Excel worspace application/vnd.ms-excel xlw Outlook mail message application/vnd.ms-outlook msg serialized certificate store file application/vnd.ms-pkicertstore sst Windows catalog file application/vnd.ms-pkiseccat cat stereolithography file application/vnd.ms-pkistl stl PowerPoint template application/vnd.ms-powerpoint pot PowerPoint slide show application/vnd.ms-powerpoint pps PowerPoint presentation application/vnd.ms-powerpoint ppt Microsoft Project file application/vnd.ms-project mpp WordPerfect macro application/vnd.ms-works wcm Microsoft Works database application/vnd.ms-works wdb Microsoft Works spreadsheet application/vnd.ms-works wks Microsoft Works word processsor document application/vnd.ms-works wps Windows help file application/winhlp hlp binary CPIO archive application/x-bcpio bcpio computable document format file application/x-cdf cdf Unix compressed file application/x-compress z gzipped tar file application/x-compressed tgz Unix CPIO archive application/x-cpio cpio Photoshop custom shapes file application/x-csh csh Kodak RAW image file application/x-director dcr Adobe Director movie application/x-director dir Macromedia Director movie application/x-director dxr device independent format file application/x-dvi dvi Gnu tar archive application/x-gtar gtar Gnu zipped archive application/x-gzip gz hierarchical data format file application/x-hdf hdf internet settings file application/x-internet-signup ins IIS internet service provider settings application/x-internet-signup isp ARC+ architectural file application/x-iphone iii JavaScript file application/x-javascript js LaTex document application/x-latex latex Microsoft Access database application/x-msaccess mdb Windows CardSpace file application/x-mscardfile crd CrazyTalk clip file application/x-msclip clp dynamic link library application/x-msdownload dll Microsoft media viewer file application/x-msmediaview m13 Steuer2001 file application/x-msmediaview m14 multimedia viewer book source file application/x-msmediaview mvb Windows meta file application/x-msmetafile wmf Microsoft Money file application/x-msmoney mny Microsoft Publisher file application/x-mspublisher pub Turbo Tax tax schedule list application/x-msschedule scd FTR media file application/x-msterminal trm Microsoft Write file application/x-mswrite wri computable document format file application/x-netcdf cdf Mastercam numerical control file application/x-netcdf nc MSX computers archive format application/x-perfmon pma performance monitor counter file application/x-perfmon pmc process monitor log file application/x-perfmon pml Avid persistant media record file application/x-perfmon pmr Pegasus Mail draft stored message application/x-perfmon pmw personal information exchange file application/x-pkcs12 p12 PKCS #12 certificate file application/x-pkcs12 pfx PKCS #7 certificate file application/x-pkcs7-certificates p7b software publisher certificate file application/x-pkcs7-certificates spc certificate request response file application/x-pkcs7-certreqresp p7r PKCS #7 certificate file application/x-pkcs7-mime p7c digitally encrypted message application/x-pkcs7-mime p7m digitally signed email message application/x-pkcs7-signature p7s Bash shell script application/x-sh sh Unix shar archive application/x-shar shar Flash file application/x-shockwave-flash swf Stuffit archive file application/x-stuffit sit system 5 release 4 CPIO file application/x-sv4cpio sv4cpio system 5 release 4 CPIO checksum data application/x-sv4crc sv4crc consolidated Unix file archive application/x-tar tar Tcl script application/x-tcl tcl LaTeX source document application/x-tex tex LaTeX info document application/x-texinfo texi LaTeX info document application/x-texinfo texinfo unformatted manual page application/x-troff roff Turing source code file application/x-troff t TomeRaider 2 ebook file application/x-troff tr Unix manual application/x-troff-man man readme text file application/x-troff-me me 3ds Max script file application/x-troff-ms ms uniform standard tape archive format file application/x-ustar ustar source code application/x-wais-source src internet security certificate application/x-x509-ca-cert cer security certificate application/x-x509-ca-cert crt DER certificate file application/x-x509-ca-cert der public key security object application/ynd.ms-pkipko pko zipped file application/zip zip Sound Files MIME Type Application MIME Type File Extension audio file audio/basic au sound file audio/basic snd midi file audio/mid mid media processing server studio audio/mid rmi MP3 file audio/mpeg mp3 audio interchange file format audio/x-aiff aif compressed audio interchange file audio/x-aiff aifc audio interchange file format audio/x-aiff aiff media playlist file audio/x-mpegurl m3u Real Audio file audio/x-pn-realaudio ra Real Audio metadata file audio/x-pn-realaudio ram WAVE audio file audio/x-wav wav Image Files MIME Type Application MIME Type File Extension Bitmap image/bmp bmp compiled source code image/cis-cod cod graphic interchange format image/gif gif image file image/ief ief JPEG image image/jpeg jpe JPEG image image/jpeg jpeg JPEG image image/jpeg jpg JPEG file interchange format image/pipeg jfif scalable vector graphic image/svg+xml svg TIF image image/tiff tif TIF image image/tiff tiff Sun raster graphic image/x-cmu-raster ras Corel metafile exchange image file image/x-cmx cmx icon image/x-icon ico portable any map image image/x-portable-anymap pnm portable bitmap image image/x-portable-bitmap pbm portable graymap image image/x-portable-graymap pgm portable pixmap image image/x-portable-pixmap ppm RGB bitmap image/x-rgb rgb X11 bitmap image/x-xbitmap xbm X11 pixmap image/x-xpixmap xpm X-Windows dump image image/x-xwindowdump xwd Mail Message Files MIME Type Application MIME Type File Extension MHTML web archive message/rfc822 mht MIME HTML file message/rfc822 mhtml Windows Live Mail newsgroup file message/rfc822 nws Text Files MIME Type Application MIME Type File Extension Cascading Style Sheet text/css css H.323 internet telephony file text/h323 323 HTML file text/html htm HTML file text/html html Exchange streaming media file text/html stm NetMeeting user location service file text/iuls uls BASIC source code file text/plain bas C/C++ source code file text/plain c C/C++/Objective C header file text/plain h text file text/plain txt rich text file text/richtext rtx Scitext continuous tone file text/scriptlet sct tab separated values file text/tab-separated-values tsv hypertext template file text/webviewhtml htt HTML component file text/x-component htc TeX font encoding file text/x-setext etx vCard file text/x-vcard vcf Video Files MIME Type Application MIME Type File Extension MPEG-2 audio file video/mpeg mp2 MPEG-2 audio file video/mpeg mpa MPEG movie file video/mpeg mpe MPEG movie file video/mpeg mpeg MPEG movie file video/mpeg mpg MPEG-2 video stream video/mpeg mpv2 MPEG-4 video/mp4 mp4 Apple QuickTime movie video/quicktime mov Apple QuickTime movie video/quicktime qt Logos library system file video/x-la-asf lsf streaming media shortcut video/x-la-asf lsx advanced systems format file video/x-ms-asf asf ActionScript remote document video/x-ms-asf asr Microsoft ASF redirector file video/x-ms-asf asx audio video interleave file video/x-msvideo avi Apple QuickTime movie video/x-sgi-movie movie Virtual World Files MIME Type Application MIME Type File Extension Flare decompiled actionscript file x-world/x-vrml flr VRML file x-world/x-vrml vrml VRML world x-world/x-vrml wrl compressed VRML world x-world/x-vrml wrz 3ds max XML animation file x-world/x-vrml xaf Reality Lab 3D image file x-world/x-vrml xof 参考文献微软办公文件 MIME Typesinput[file]标签的accept=”image/*”属性响应很慢的解决办法A List of MIME Types by Content TypeMedia Types","tags":[{"name":"HTML5","slug":"HTML5","permalink":"http://zhensherlock.github.io/tags/HTML5/"},{"name":"MIME","slug":"MIME","permalink":"http://zhensherlock.github.io/tags/MIME/"}]},{"title":"使用OpenXml实现生成数据字典文档","date":"2016-04-29T08:54:17.000Z","path":"2016/04/29/openxml-generate-data-dictionary/","text":"导语 最近项目在走验收流程，之前没有仔细看SOW文档，发现需要补好多份文档，其中就有数据字典，项目组不愿意花时间太多的时间弄这些文档，也不希望以后还要重复劳动力，最终决定做一个工具，方便自己生成数据字典文档。 正文这里只是分享一下开发的思路和经历（如果发现有问题，请及时告诉我，我会即时纠正，以免误导他人，欢迎大家多多指点）。 投影未脱机的数据库列表（使用T-SQL） 投影当前数据库的表列表（使用T-SQL） 投影某表的字段信息列表（使用T-SQL） 使用OpenXml新建总文档 使用OpenXml开始生成单张表的数据字典，替换书签 使用OpenXml添加表格，完成单张表的数据字典docx文档 使用OpenXml将当前文档合并成到总文档中 工具的界面大体如下： 图1 投影未脱机的数据库列表（使用T-SQL）SELECT Name FROM Master..SysDatabases WHERE STATUS = 65536 ORDER BY Name 投影当前数据库的表列表（使用T-SQL）USE TestDB;SELECT Name FROM SysObjects Where XType='U' ORDER BY Name DESC 投影某表的字段信息列表（使用T-SQL）USE TestDB;SELECTa.name 字段名 ,( CASE WHEN COLUMNPROPERTY(a.id, a.name, 'IsIdentity') = 1 THEN '√' ELSE ''END ) 标识 ,( CASE WHEN ( SELECT COUNT(*) FROM sysobjects WHERE ( name IN ( SELECT name FROM sysindexes WHERE ( id = a.id ) AND ( indid IN ( SELECT indid FROM sysindexkeys WHERE ( id = a.id ) AND ( colid IN ( SELECT colid FROM syscolumns WHERE ( id = a.id ) AND ( name = a.name ) ) ) ) ) ) ) AND ( xtype = 'PK' ) ) &gt; 0 THEN '√' ELSE ''END ) 主键 ,( CASE b.name WHEN 'varchar' THEN b.name + '(' + cast(a.length as varchar(8)) + ')' WHEN 'nvarchar' THEN b.name + '(' + cast(a.length as varchar(8)) + ')' ELSE b.nameEND ) 类型 ,( CASE WHEN a.isnullable = 1 THEN '√' ELSE ''END ) 允许空 ,( CASE a.name WHEN 'Id' THEN 'Id' WHEN 'AddTime' THEN '添加时间' WHEN 'UpdateTime' THEN '修改时间' WHEN 'IsValid' THEN '删除标记' WHEN 'AddIp' THEN '添加IP地址' WHEN 'UpdateIp' THEN '修改IP地址' WHEN 'State' THEN '状态' WHEN 'PicUrl' THEN '图片地址' WHEN 'Image' THEN '图片地址' WHEN 'Description' THEN '介绍' WHEN 'Title' THEN '标题' WHEN 'Note' THEN '备注' WHEN 'Type' THEN '类型' WHEN 'Content' THEN '内容' END ) 字段中文名,ISNULL(e.text, '') 默认值,'' as 备注FROM syscolumns a LEFT JOIN systypes b ON a.xtype = b.xusertype INNER JOIN sysobjects d ON a.id = d.id AND d.xtype = 'U' AND d.name &lt;&gt; 'dtproperties' LEFT JOIN syscomments e ON a.cdefault = e.id LEFT JOIN sys.extended_properties g ON a.id = g.major_id AND a.colid = g.minor_id LEFT JOIN sys.extended_properties f ON d.id = f.class AND f.minor_id = 0WHERE b.name IS NOT NULLand d.name='Account'ORDER BY a.id , a.colorder; 使用OpenXml新建总文档tmplFilePath是临时存放各个表数据字典的文件夹string path = string.Format(@\"&#123;0&#125;&#123;1&#125;.docx\", tmplFilePath, DateTime.Now.Ticks.ToString());using (WordprocessingDocument doc = WordprocessingDocument.Create(path, WordprocessingDocumentType.Document))&#123; MainDocumentPart mainPart = doc.AddMainDocumentPart(); mainPart.Document = new Document(); Body body = mainPart.Document.AppendChild(new Body()); Paragraph p = mainPart.Document.Body.AppendChild(new Paragraph()); p.AppendChild(new Run(new Text(\"数据字典\"))); &#125; 使用OpenXml开始生成单张表的数据字典，替换书签tmplFileName是单张表的数据字典文档路径using (WordprocessingDocument tmplDoc = WordprocessingDocument.Open(tmplFileName, true))&#123; //修改文档类型 (dotx-&gt;docx) tmplDoc.ChangeDocumentType(WordprocessingDocumentType.Document); var bookMarks = FindBookmarks(tmplDoc.MainDocumentPart.Document); //替换书签 foreach (var end in bookMarks) &#123; if (end.Key == \"TableName\") &#123; var textElement = new Text(tableName); var runElement = new Run(textElement); end.Value.InsertAfterSelf(runElement); &#125; &#125;&#125; 下面是FindBookmarks方法private Dictionary&lt;string, BookmarkEnd&gt; FindBookmarks(OpenXmlElement documentPart, Dictionary&lt;string, BookmarkEnd&gt; results = null, Dictionary&lt;string, string&gt; unmatched = null)&#123; results = results ?? new Dictionary&lt;string, BookmarkEnd&gt;(); unmatched = unmatched ?? new Dictionary&lt;string, string&gt;(); foreach (var child in documentPart.Elements()) &#123; if (child is BookmarkStart) &#123; var bStart = child as BookmarkStart; unmatched.Add(bStart.Id, bStart.Name); &#125; if (child is BookmarkEnd) &#123; var bEnd = child as BookmarkEnd; foreach (var orphanName in unmatched) &#123; if (bEnd.Id == orphanName.Key) results.Add(orphanName.Value, bEnd); &#125; &#125; FindBookmarks(child, results, unmatched); &#125; return results;&#125; 使用OpenXml添加表格，完成单张表的数据字典docx文档//设置表格属性TableProperties tblProp = new TableProperties( new TableBorders( new TopBorder() &#123; Val = new EnumValue&lt;BorderValues&gt;(BorderValues.Single), Size = 1 &#125;, new BottomBorder() &#123; Val = new EnumValue&lt;BorderValues&gt;(BorderValues.Single), Size = 1 &#125;, new LeftBorder() &#123; Val = new EnumValue&lt;BorderValues&gt;(BorderValues.Single), Size = 1 &#125;, new RightBorder() &#123; Val = new EnumValue&lt;BorderValues&gt;(BorderValues.Single), Size = 1 &#125;, new InsideHorizontalBorder() &#123; Val = new EnumValue&lt;BorderValues&gt;(BorderValues.Single), Size = 1 &#125;, new InsideVerticalBorder() &#123; Val = new EnumValue&lt;BorderValues&gt;(BorderValues.Single), Size = 1 &#125; ));Table table = new Table();table.Append(tblProp);//添加表头TableRow headerRow = new TableRow();foreach (DataColumn column in dataBaseTable.Columns)&#123; TableCell cell = new TableCell(); cell.Append(new Paragraph(new Run(new Text(column.ColumnName)))); headerRow.Append(cell);&#125;table.Append(headerRow);//添加数据foreach (DataRow row in dataBaseTable.Rows)&#123; TableRow tableRow = new TableRow(); foreach (object strCell in row.ItemArray) &#123; TableCell cell = new TableCell(); cell.Append(new Paragraph(new Run(new Text(strCell.ToString())))); tableRow.Append(cell); &#125; table.Append(tableRow);&#125;//添加表格tmplDoc.MainDocumentPart.Document.Body.Append(new Paragraph(new Run(table))); 使用OpenXml将当前文档合并到总文档中path是总文档的路径tmplFileName是当前文档的路径//将当前word和总文档的合并using (WordprocessingDocument template = WordprocessingDocument.Open(path, true))&#123; MainDocumentPart mainPart = template.MainDocumentPart; string altChunkId = tableName; AlternativeFormatImportPart chunk = mainPart.AddAlternativeFormatImportPart( AlternativeFormatImportPartType.WordprocessingML, altChunkId); using (FileStream fileStream = File.Open(tmplFileName, FileMode.Open)) chunk.FeedData(fileStream); AltChunk altChunk = new AltChunk(); altChunk.Id = altChunkId; mainPart.Document .Body .InsertAfter(altChunk, mainPart.Document.Body .Elements&lt;Paragraph&gt;().Last()); mainPart.Document.Save();&#125; 最终效果 图2 任务完成，这里是源代码，晚安！","tags":[{"name":"C#","slug":"C","permalink":"http://zhensherlock.github.io/tags/C/"},{"name":"WinForm","slug":"WinForm","permalink":"http://zhensherlock.github.io/tags/WinForm/"},{"name":"OpenXml","slug":"OpenXml","permalink":"http://zhensherlock.github.io/tags/OpenXml/"}]},{"title":"Photoshop 将点转换成PX","date":"2016-04-28T01:35:31.000Z","path":"2016/04/28/photoshop-convert-px/","text":"正文打开Photoshop首选项——编辑，选择单“位与标尺”，如下界面： 图1 选择后出现如下界面，选择像素即可 图2","tags":[{"name":"Photoshop","slug":"Photoshop","permalink":"http://zhensherlock.github.io/tags/Photoshop/"}]},{"title":"SQL Server 获取插入记录后的自增ID","date":"2016-04-27T01:07:40.000Z","path":"2016/04/27/sql-server-identity/","text":"导语 有时我们在写SQL语句时，会遇到在插入一条记录的后要立即获取所在数据库中的ID，而该ID是自增生成的。 正文如果我们要获取自增的ID，最简单的方法就是在INSERT语句之后select @@indentity，但是如果插入的表有INSERT触发器，那使用select @@indentity就会不对。例如，有两个表 T1 和 T2（T1 和 T2 都有 IDENTITY 列），在 T1 上定义了一个 INSERT 触发器。当 T1 插入数据时，T1 的INSERT触发器被触发，并在 T2 中插入一行，这时 @@IDENTITY 返回插入到当前会话中任何作用域内的最后一个 IDENTITY 列值，所以该值是插入 T2 中的ID。在SQL Server 中还有其他两个函数可以获取插入到 IDENTITY 列中的值，分别是：SCOPE_IDENTITY、IDENT_CURRENT，接一下我们来分别了解一下各自的语法。 @@IDENTITY 返回为当前会话的所有作用域中的任何表最后生成的标识值。 SCOPE_IDENTITY 返回为当前会话和当前作用域中的任何表最后生成的标识值。 IDENT_CURRENT 返回为任何会话和任何作用域中的特定表最后生成的标识值，它不受作用域和会话的限制，而受限于所指定的表。 按照其语法的来看，我们可以推断出各个函数应用到上面例子中的结果分别是： @@IDENTITY 返回插入到当前会话中任何作用域内的最后一个 IDENTITY 列值，该值是插入 T2 中的值。 SCOPE_IDENTITY 返回插入 T1 中的 IDENTITY 值，该值是发生在相同作用域中的最后一个 INSERT。如果在作用域中发生插入语句到标识列之前唤醒调用 SCOPE_IDENTITY() 函数，则该函数将返回 NULL 值。 而IDENT_CURRENT(‘T1’) 和 IDENT_CURRENT(‘T2’) 返回的值分别是这两个表最后自增的值。 参考文献使用SQL Server 获取插入记录后的ID(自动编号)","tags":[{"name":"SQL Server","slug":"SQL-Server","permalink":"http://zhensherlock.github.io/tags/SQL-Server/"}]},{"title":"JSLint Missing Radix Parameter","date":"2016-04-21T08:44:37.000Z","path":"2016/04/21/jslint-missing-radix-parameter/","text":"文正使用JSLint检查javascript代码语法时，会遇到很多无头绪的报错，比如：Missing radix parameter。 这个错误信息主要是因为我们没有深刻掌握parseInt语法，意思是缺少一个基数根，也就是指parseInt的第二个参数没有指定。 parseInt的第二个参数有四种:2、8、10、16，分别对应二进制、八进制、十进制、十六进制；默认是:十进制；在转换时可以忽略第二个参数，这样js照样可以运行，但是在你进行语法校验时，JSLint却会报错，这是因为压缩工具对语法的严谨性要求比较高，建议大家在用parseInt语法进行转换时，最好加个第二个参数。 参考文献javascript报错：Missing radix parameter","tags":[{"name":"JSLint","slug":"JSLint","permalink":"http://zhensherlock.github.io/tags/JSLint/"},{"name":"JavaScript","slug":"JavaScript","permalink":"http://zhensherlock.github.io/tags/JavaScript/"}]},{"title":"SQL Server Case When 用法","date":"2016-04-19T00:41:52.000Z","path":"2016/04/19/sql-server-case-when/","text":"文正Case When有两种用法。分别是：简单Case函数和Case搜索函数。 简单Case函数CASE sex WHEN '1' THEN '男' WHEN '2' THEN '女'ELSE '其他' END Case搜索函数CASE WHEN sex = '1' THEN '男' WHEN sex = '2' THEN '女'ELSE '其他' END 参考文献SqlServer Case When用法","tags":[{"name":"SQL Server","slug":"SQL-Server","permalink":"http://zhensherlock.github.io/tags/SQL-Server/"}]},{"title":"Visual Studio远程调试","date":"2016-04-14T09:59:22.000Z","path":"2016/04/14/visual-studio-remote-debugger/","text":"导语 在开发的时候，我们有时会用远程调试工具进行debug，本文就简单的介绍一下如何使用Visual Studio自带的远程调试工具（我们以VS2012为例）。 步骤找到Remote Debugger Folder文件夹 图1 图2 接一下我们使用“无身份验证”并勾选“允许任何用户进行调试”；将最长空闲时间设置多点。 图3 图4 图5 但是在调试网站的时候，有好几个网站，我们无法确定是哪个w3wap.exe；我们可以使用命令查看PID1）对于IIS6,可以“开始”-》运行，输入 “iisapp -a ”来显示应用程序池w3wp.exe进程对应的pid和进程池名称。iisapp.vbs它是一个脚本程序,在安装2003时需要SP1才有。2）IIS7可以直接用它的外壳命令假定C盘是系统盘1：cd C:/Windows/System32/inetsrv2：appcmd.exe list wp 参考文献远程调试步骤查看PID","tags":[{"name":"Visual Studio","slug":"Visual-Studio","permalink":"http://zhensherlock.github.io/tags/Visual-Studio/"}]},{"title":"SQL Server 递归函数","date":"2016-04-14T08:54:19.000Z","path":"2016/04/14/sql-server-recursion/","text":"导语 有时我们在设计表结构时，会遇到主键关联到自身表的parentid，这时我们就会需要传递一个id，将所有的子集都获取出来。 需要补习的语法 WITH AS摘自网上WITH AS短语，也叫做子查询部分（subquery factoring），可以让你做很多事情，定义一个SQL片断，该SQL片断会被整个SQL语句所用到。有的时候，是为了让SQL语句的可读性更高些，也有可能是在UNION ALL的不同部分，作为提供数据的部分。特别对于UNION ALL比较有用。因为UNION ALL的每个部分可能相同，但是如果每个部分都去执行一遍的话，则成本太高，所以可以使用WITH AS短语，则只要执行一遍即可。如果WITH AS短语所定义的表名被调用两次以上，则优化器会自动将WITH AS短语所获取的数据放入一个TEMP表里，如果只是被调用一次，则不会。而提示materialize则是强制将WITH AS短语里的数据放入一个全局临时表里。很多查询通过这种方法都可以提高速度。 实例WITH cte AS ( SELECT dept_id , dept_name FROM department WHERE dept_id = '1111' UNION ALL SELECT d.dept_id , d.dept_name FROM cte c INNER JOIN department d ON c.dept_id = d.parent_id )SELECT dept_idFROM cte; 参考文献SQL递归查询(with cte as)SQL中使用WITH AS提高性能－使用公用表表达式（CTE）简化嵌套SQL","tags":[{"name":"SQL Server","slug":"SQL-Server","permalink":"http://zhensherlock.github.io/tags/SQL-Server/"}]},{"title":"CSS优先级计算","date":"2016-04-08T08:04:00.000Z","path":"2016/04/08/css-priority/","text":"导语 前端开发时，经常会遇到当前元素需要覆盖样式的需求，这篇我们来了解一下css是如何来确定当前使用哪种样式的。 正文 类型 权值 内联样式表 1000 ID 选择器 100 Class 类选择器 10 HTML 标签选择器 1","tags":[{"name":"CSS","slug":"CSS","permalink":"http://zhensherlock.github.io/tags/CSS/"}]},{"title":"移动前端头部标签","date":"2016-04-07T01:04:00.000Z","path":"2016/04/07/html5-head-meta/","text":"导语 移动前端开发中添加一些webkit专属的HTML5头部标签，帮助浏览器更好解析html代码，更好地将移动web前端页面表现出来。本文整理一些常用的meta标签。 基本设置&lt;!DOCTYPE html&gt;使用 HTML5 doctype，不区分大小写&lt;html lang=&quot;zh-cmn-Hans&quot;&gt;更加标准的 lang 属性写法 重点&lt;!-- 声明文档使用的字符编码 --&gt;&lt;meta charset='utf-8'&gt;&lt;!-- 优先使用 IE 最新版本和 Chrome --&gt;&lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\"/&gt;&lt;!-- 页面描述 --&gt;&lt;meta name=\"description\" content=\"不超过150个字符\"/&gt;&lt;!-- 页面关键词 --&gt;&lt;meta name=\"keywords\" content=\"\"/&gt;&lt;!-- 网页作者 --&gt;&lt;meta name=\"author\" content=\"name, email@gmail.com\"/&gt;&lt;!-- 搜索引擎抓取 --&gt;&lt;meta name=\"robots\" content=\"index,follow\"/&gt;&lt;!-- 为移动设备添加 viewport --&gt;&lt;meta name=\"viewport\" content=\"initial-scale=1, maximum-scale=3, minimum-scale=1, user-scalable=no\"&gt;&lt;!-- `width=device-width` 会导致 iPhone 5 添加到主屏后以 WebApp 全屏模式打开页面时出现黑边 http://bigc.at/ios-webapp-viewport-meta.orz --&gt;&lt;!-- iOS 设备 begin --&gt;&lt;meta name=\"apple-mobile-web-app-title\" content=\"标题\"&gt;&lt;!-- 添加到主屏后的标题（iOS 6 新增） --&gt;&lt;meta name=\"apple-mobile-web-app-capable\" content=\"yes\"/&gt;&lt;!-- 是否启用 WebApp 全屏模式，删除苹果默认的工具栏和菜单栏 --&gt;&lt;meta name=\"apple-itunes-app\" content=\"app-id=myAppStoreID, affiliate-data=myAffiliateData, app-argument=myURL\"&gt;&lt;!-- 添加智能 App 广告条 Smart App Banner（iOS 6+ Safari） --&gt;&lt;meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\"/&gt;&lt;!-- 设置苹果工具栏颜色 --&gt;&lt;meta name=\"format-detection\" content=\"telphone=no, email=no\"/&gt;&lt;!-- 忽略页面中的数字识别为电话，忽略email识别 --&gt;&lt;!-- 启用360浏览器的极速模式(webkit) --&gt;&lt;meta name=\"renderer\" content=\"webkit\"&gt;&lt;!-- 避免IE使用兼容模式 --&gt;&lt;meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"&gt;&lt;!-- 不让百度转码 --&gt;&lt;meta http-equiv=\"Cache-Control\" content=\"no-siteapp\" /&gt;&lt;!-- 针对手持设备优化，主要是针对一些老的不识别viewport的浏览器，比如黑莓 --&gt;&lt;meta name=\"HandheldFriendly\" content=\"true\"&gt;&lt;!-- 微软的老式浏览器 --&gt;&lt;meta name=\"MobileOptimized\" content=\"320\"&gt;&lt;!-- uc强制竖屏 --&gt;&lt;meta name=\"screen-orientation\" content=\"portrait\"&gt;&lt;!-- QQ强制竖屏 --&gt;&lt;meta name=\"x5-orientation\" content=\"portrait\"&gt;&lt;!-- UC强制全屏 --&gt;&lt;meta name=\"full-screen\" content=\"yes\"&gt;&lt;!-- QQ强制全屏 --&gt;&lt;meta name=\"x5-fullscreen\" content=\"true\"&gt;&lt;!-- UC应用模式 --&gt;&lt;meta name=\"browsermode\" content=\"application\"&gt;&lt;!-- QQ应用模式 --&gt;&lt;meta name=\"x5-page-mode\" content=\"app\"&gt;&lt;!-- windows phone 点击无高光 --&gt;&lt;meta name=\"msapplication-tap-highlight\" content=\"no\"&gt;&lt;!-- iOS 图标 begin --&gt;&lt;link rel=\"apple-touch-icon-precomposed\" href=\"/apple-touch-icon-57x57-precomposed.png\"/&gt;&lt;!-- iPhone 和 iTouch，默认 57x57 像素，必须有 --&gt;&lt;link rel=\"apple-touch-icon-precomposed\" sizes=\"114x114\" href=\"/apple-touch-icon-114x114-precomposed.png\"/&gt;&lt;!-- Retina iPhone 和 Retina iTouch，114x114 像素，可以没有，但推荐有 --&gt;&lt;link rel=\"apple-touch-icon-precomposed\" sizes=\"144x144\" href=\"/apple-touch-icon-144x144-precomposed.png\"/&gt;&lt;!-- Retina iPad，144x144 像素，可以没有，但推荐有 --&gt;&lt;!-- iOS 图标 end --&gt;&lt;!-- iOS 启动画面 begin --&gt;&lt;link rel=\"apple-touch-startup-image\" sizes=\"768x1004\" href=\"/splash-screen-768x1004.png\"/&gt;&lt;!-- iPad 竖屏 768 x 1004（标准分辨率） --&gt;&lt;link rel=\"apple-touch-startup-image\" sizes=\"1536x2008\" href=\"/splash-screen-1536x2008.png\"/&gt;&lt;!-- iPad 竖屏 1536x2008（Retina） --&gt;&lt;link rel=\"apple-touch-startup-image\" sizes=\"1024x748\" href=\"/Default-Portrait-1024x748.png\"/&gt;&lt;!-- iPad 横屏 1024x748（标准分辨率） --&gt;&lt;link rel=\"apple-touch-startup-image\" sizes=\"2048x1496\" href=\"/splash-screen-2048x1496.png\"/&gt;&lt;!-- iPad 横屏 2048x1496（Retina） --&gt;&lt;link rel=\"apple-touch-startup-image\" href=\"/splash-screen-320x480.png\"/&gt;&lt;!-- iPhone/iPod Touch 竖屏 320x480 (标准分辨率) --&gt;&lt;link rel=\"apple-touch-startup-image\" sizes=\"640x960\" href=\"/splash-screen-640x960.png\"/&gt;&lt;!-- iPhone/iPod Touch 竖屏 640x960 (Retina) --&gt;&lt;link rel=\"apple-touch-startup-image\" sizes=\"640x1136\" href=\"/splash-screen-640x1136.png\"/&gt;&lt;!-- iPhone 5/iPod Touch 5 竖屏 640x1136 (Retina) --&gt;&lt;!-- iOS 启动画面 end --&gt;&lt;!-- iOS 设备 end --&gt;&lt;meta name=\"msapplication-TileColor\" content=\"#000\"/&gt;&lt;!-- Windows 8 磁贴颜色 --&gt;&lt;meta name=\"msapplication-TileImage\" content=\"icon.png\"/&gt;&lt;!-- Windows 8 磁贴图标 --&gt;&lt;link rel=\"alternate\" type=\"application/rss+xml\" title=\"RSS\" href=\"/rss.xml\"/&gt;&lt;!-- 添加 RSS 订阅 --&gt;&lt;link rel=\"shortcut icon\" type=\"image/ico\" href=\"/favicon.ico\"/&gt;&lt;!-- 添加 favicon icon --&gt;&lt;!-- sns 社交标签 begin --&gt;&lt;!-- 参考微博API --&gt;&lt;meta property=\"og:type\" content=\"类型\" /&gt;&lt;meta property=\"og:url\" content=\"URL地址\" /&gt;&lt;meta property=\"og:title\" content=\"标题\" /&gt;&lt;meta property=\"og:image\" content=\"图片\" /&gt;&lt;meta property=\"og:description\" content=\"描述\" /&gt;&lt;!-- sns 社交标签 end --&gt;","tags":[{"name":"HTML5","slug":"HTML5","permalink":"http://zhensherlock.github.io/tags/HTML5/"},{"name":"META","slug":"META","permalink":"http://zhensherlock.github.io/tags/META/"}]},{"title":"Hello World","date":"2016-04-04T08:08:27.660Z","path":"2016/04/04/hello-world/","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post$ hexo new \"My New Post\" More info: Writing Run server$ hexo server More info: Server Generate static files$ hexo generate More info: Generating Deploy to remote sites$ hexo deploy More info: Deployment","tags":[{"name":"Hello World","slug":"Hello-World","permalink":"http://zhensherlock.github.io/tags/Hello-World/"}]}]